{
  "_comment": "äºŒåˆ†æŸ¥æ‰¾åˆ†é•œæ¨¡æ¿ â€” é€‚ç”¨äºï¼šæœ‰åºæ•°ç»„æŸ¥æ‰¾ã€upper/lower boundã€æ—‹è½¬æ•°ç»„æŸ¥æ‰¾",
  "_usage": "å°†æ­¤æ¨¡æ¿å¡«å…¥ storyboard.jsonï¼Œæ›¿æ¢æ‰€æœ‰ FILL_IN å ä½ç¬¦",
  "title": "FILL_IN_é¢˜ç›®åç§°ï¼ˆå¦‚ï¼šäºŒåˆ†æŸ¥æ‰¾ç›®æ ‡å€¼ï¼‰",
  "subject": "ç®—æ³•",
  "algorithm_type": "binary_search",
  "operation": "FILL_INï¼ˆsearch / lower_bound / upper_boundï¼‰",
  "segments": [
    {
      "id": "intro",
      "segment_no": 1,
      "type": "title_card",
      "duration_hint_s": "4~6",
      "narration": "ä»Šå¤©æˆ‘ä»¬æ¥å­¦ä¹ ã€ŒäºŒåˆ†æŸ¥æ‰¾ã€ï¼Œå£è¯€æ˜¯ï¼šæ¯æ¬¡ç¼©å°ä¸€åŠï¼Œå¾ˆå¿«å°±èƒ½æ‰¾åˆ°ï¼",
      "visual": {
        "layout": "å±…ä¸­é“ºæ»¡",
        "elements": [
          {"role": "ä¸»æ ‡é¢˜", "text": "äºŒåˆ†æŸ¥æ‰¾", "style": "font_size=52, BOLD, WHITE"},
          {"role": "å‰¯æ ‡é¢˜/å£è¯€", "text": "æ¯æ¬¡ç¼©å°ä¸€åŠï¼ŒO(log n) è¶…çº§å¿«ï¼", "style": "font_size=28, C_MUTED"}
        ],
        "animation_sequence": [
          "FadeIn(ä¸»æ ‡é¢˜, shift=UP*0.3), run_time=0.8",
          "FadeIn(å‰¯æ ‡é¢˜), run_time=0.5",
          "wait(çº¦3ç§’)",
          "FadeOut(VGroup)"
        ]
      }
    },
    {
      "id": "problem",
      "segment_no": 2,
      "type": "text_card",
      "duration_hint_s": "10~16",
      "narration": "FILL_IN_å®Œæ•´æœ—è¯»é¢˜ç›®ã€‚è¯´æ˜æœ‰åºæ•°ç»„å’Œè¦æŸ¥æ‰¾çš„ç›®æ ‡å€¼ã€‚",
      "narration_example": "ç»™å®šä¸€ä¸ªä»å°åˆ°å¤§æ’å¥½åºçš„æ•°ç»„ï¼Œé‡Œé¢æœ‰8ä¸ªæ•°ï¼š1ã€3ã€5ã€7ã€9ã€11ã€13ã€15ã€‚ç°åœ¨è¦æ‰¾ç›®æ ‡å€¼7ï¼Œæ‰¾åˆ°äº†è¿”å›å®ƒçš„ç´¢å¼•ï¼Œæ‰¾ä¸åˆ°è¿”å›-1ã€‚",
      "visual": {
        "layout": "å±…ä¸­å¸¦åœ†è§’æ·±è“å¡ç‰‡",
        "elements": [
          {"role": "è§’æ ‡ç­¾", "text": "é¢˜  ç›®", "style": "font_size=18, C_MUTED, to_corner(UL)"},
          {
            "role": "é¢˜ç›®æ–‡æœ¬",
            "lines": [
              "FILL_IN_ç¬¬ä¸€è¡Œï¼ˆå¦‚ï¼šç»™å®šæœ‰åºæ•°ç»„ nums = [1,3,5,7,9,11,13,15]ï¼‰",
              "FILL_IN_ç¬¬äºŒè¡Œï¼ˆå¦‚ï¼šåœ¨æ•°ç»„ä¸­æŸ¥æ‰¾ç›®æ ‡å€¼ target = 7ï¼‰",
              "FILL_IN_ç¬¬ä¸‰è¡Œï¼ˆå¦‚ï¼šæ‰¾åˆ°è¿”å›ç´¢å¼•ï¼Œæ‰¾ä¸åˆ°è¿”å› -1ï¼‰"
            ],
            "style": "font_size=26, C_TEXT, å·¦å¯¹é½"
          }
        ],
        "animation_sequence": [
          "FadeIn(è§’æ ‡ç­¾)",
          "DrawBorderThenFill(å¡ç‰‡)",
          "FadeIn(æ–‡å­—)",
          "wait(çº¦10ç§’)",
          "FadeOut(å…¨éƒ¨)"
        ]
      }
    },
    {
      "id": "draw",
      "segment_no": 3,
      "type": "array_draw",
      "duration_hint_s": "7~10",
      "narration": "FILL_IN_æè¿°ç”»æ•°ç»„è¿‡ç¨‹ã€‚ç”»å‡ºæ ¼å­ï¼Œæ ‡å‡ºå€¼å’Œç´¢å¼•ç¼–å·ã€‚",
      "narration_example": "æˆ‘ä»¬æŠŠè¿™ä¸ªæœ‰åºæ•°ç»„ç”»å‡ºæ¥ã€‚æ¯ä¸ªæ ¼å­é‡Œæ”¾ä¸€ä¸ªæ•°ï¼Œä¸‹é¢æ ‡ä¸Šç´¢å¼•ç¼–å·ï¼Œä»0å¼€å§‹ã€‚",
      "visual": {
        "layout": "æ•°ç»„æ°´å¹³æ’åˆ—ï¼Œæ•´ä½“å±…ä¸­ï¼Œy=0ï¼›ä¸‹æ–¹æœ‰ç´¢å¼•æ ‡ç­¾",
        "coordinate_system": "æ ¼å­å¤§å°0.7ï¼Œæ ¼å­é—´è·0ï¼ˆç´§é ï¼‰ï¼Œæ•´ä½“ start_x = -(n-1)*0.35",
        "manim_objects": {
          "cell":    "make_cell(val, idx, pos)  â†’ VGroup(Square(0.7), Text(val), Text(idx))",
          "storage": "self._cells = [cell_VGroup, ...]  # æŒ‰ç´¢å¼•é¡ºåº"
        },
        "layout_formula": {
          "n": "len(arr_vals)",
          "start_x": "-(n-1) * 0.35",
          "cell_x": "start_x + i * 0.7"
        },
        "array_values": "FILL_IN_æ•°ç»„å€¼ï¼ˆå¦‚ï¼š[1, 3, 5, 7, 9, 11, 13, 15]ï¼‰",
        "animation_sequence": [
          "self.play(LaggedStart(*[FadeIn(c) for c in self._cells], lag_ratio=0.1), run_time=1.0)",
          "wait(çº¦5ç§’)"
        ]
      }
    },
    {
      "id": "operation_1",
      "segment_no": 4,
      "type": "bisect_init",
      "duration_hint_s": "7~10",
      "narration": "FILL_IN_æè¿°åˆå§‹åŒ–æŒ‡é’ˆã€‚è¯´æ˜leftå’Œrightçš„åˆå§‹ä½ç½®ï¼Œè®¡ç®—ç¬¬ä¸€ä¸ªmidã€‚",
      "narration_example": "äºŒåˆ†æŸ¥æ‰¾å…ˆæŠŠleftæŒ‡å‘æœ€å·¦è¾¹çš„ç´¢å¼•0ï¼ŒrightæŒ‡å‘æœ€å³è¾¹çš„ç´¢å¼•7ã€‚ä¸­é—´çš„midç­‰äºï¼ˆ0+7ï¼‰é™¤ä»¥2ï¼Œç­‰äº3ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•3è¿™ä¸ªæ ¼å­ï¼Œå€¼æ˜¯7ã€‚",
      "visual": {
        "layout": "æ•°ç»„ä¿ç•™ï¼Œä¸‹æ–¹å‡ºç° leftâ†‘ å’Œ rightâ†‘ æŒ‡é’ˆç®­å¤´ï¼Œmidæ ¼å˜ç»¿",
        "pointers": {
          "left":  "make_bisect_arrow(cells[0], 'left', color=C_RANGE_L)",
          "right": "make_bisect_arrow(cells[-1], 'right', color=C_RANGE_R)",
          "mid":   "make_bisect_arrow(cells[mid_idx], 'mid', color=C_RANGE_MID)"
        },
        "mid_calculation": {
          "first_mid": "FILL_IN_mid = (0 + n-1) // 2",
          "highlight":  "cells[mid_idx][0].animate.set_fill(C_RANGE_MID)"
        },
        "caption": "Text('mid = (0+7)Ã·2 = 3ï¼Œarr[3]=FILL_IN_mid_val'ï¼Œæ”¾åœ¨æ•°ç»„ä¸Šæ–¹ï¼‰",
        "animation_sequence": [
          "self.play(FadeIn(left_ptr), run_time=0.4)",
          "self.play(FadeIn(right_ptr), run_time=0.4)",
          "self.play(FadeIn(mid_ptr), cells[mid].animate.set_fill(C_RANGE_MID), run_time=0.5)",
          "FadeIn(è®¡ç®—å…¬å¼è¯´æ˜æ–‡å­—)",
          "wait(çº¦5ç§’)",
          "FadeOut(è®¡ç®—è¯´æ˜æ–‡å­—)"
        ],
        "note": "å­˜å‚¨ï¼šself._left_ptr, self._right_ptr, self._mid_ptrï¼Œä»¥åŠå½“å‰ left_idx, right_idx, mid_idx"
      }
    },
    {
      "id": "operation_2",
      "segment_no": 5,
      "type": "bisect_step",
      "duration_hint_s": "16~22",
      "narration": "FILL_IN_æè¿°ç¬¬ä¸€æ¬¡ï¼ˆå’Œç¬¬äºŒæ¬¡ï¼‰è¿­ä»£ã€‚è¯´æ˜æ¯”è¾ƒç»“æœå’ŒèŒƒå›´ç¼©å°ã€‚ä¸è¶…è¿‡80å­—ã€‚",
      "narration_examples": {
        "found_at_first_mid": "arr[3]ç­‰äºç›®æ ‡å€¼7ï¼Œæ‰¾åˆ°äº†ï¼ä¸éœ€è¦å†ç»§ç»­äº†ã€‚",
        "target_smaller": "arr[3]ç­‰äº9ï¼Œæ¯”ç›®æ ‡å€¼7å¤§ï¼Œæ‰€ä»¥targetåœ¨å·¦è¾¹ï¼ŒæŠŠrightç§»åˆ°mid-1ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•2ã€‚æ–°çš„midç­‰äºï¼ˆ0+2ï¼‰é™¤ä»¥2ç­‰äº1ã€‚ç»§ç»­æŸ¥æ‰¾ï¼",
        "target_larger":  "arr[3]ç­‰äº5ï¼Œæ¯”targetå°ï¼Œæ‰€ä»¥targetåœ¨å³è¾¹ï¼ŒæŠŠleftç§»åˆ°mid+1ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•4ã€‚æ–°midç­‰äºï¼ˆ4+7ï¼‰é™¤ä»¥2ç­‰äº5ã€‚ç»§ç»­æŸ¥æ‰¾ï¼"
      },
      "visual": {
        "layout": "æ•°ç»„ä¿ç•™ï¼ŒåŠ¨æ€æ›´æ–°æŒ‡é’ˆä½ç½®å’Œæ’é™¤èŒƒå›´é®ç½©",
        "one_iteration_steps": [
          "1. æ˜¾ç¤ºæ¯”è¾ƒç¬¦å·ï¼šText('arr[mid]=FILL_IN_val  vs  target=FILL_IN_target')ï¼Œæ”¾åœ¨æ•°ç»„ä¸Šæ–¹",
          "2. è‹¥ arr[mid] == targetï¼šç›®æ ‡æ ¼å˜ C_NODE_RESULTï¼Œè·³åˆ° result æ®µ",
          "3. è‹¥ arr[mid] < targetï¼ˆtarget åœ¨å³è¾¹ï¼‰ï¼š",
          "   a. æ˜¾ç¤º Text('target åœ¨å³è¾¹ï¼Œleft = mid+1') ",
          "   b. left_ptr.animate.move_to(cells[mid+1][0].get_bottom() + DOWN*0.3)",
          "   c. make_range_mask(cells, 0, mid, C_RANGE_L) â€” å·¦ä¾§é®ç½© FadeIn",
          "   d. cells[mid][0].animate.set_fill(C_NODE_VISITED)  # mid æ ¼å˜ç°",
          "   e. é‡æ–°è®¡ç®— new_midï¼Œcells[new_mid][0].animate.set_fill(C_RANGE_MID)",
          "   f. mid_ptr.animate.move_to(æ–°ä½ç½®)",
          "4. è‹¥ arr[mid] > targetï¼ˆtarget åœ¨å·¦è¾¹ï¼‰ï¼š",
          "   a. ç±»ä¼¼ï¼Œright_ptr å·¦ç§»ï¼Œå³ä¾§é®ç½© C_RANGE_R FadeIn",
          "   b. é‡æ–°è®¡ç®— new_mid"
        ],
        "iteration_count": "FILL_IN_è¿­ä»£æ¬¡æ•°ï¼ˆé€šå¸¸å±•ç¤º2~3æ¬¡è¿­ä»£å°±å¤Ÿè¯´æ˜åŸç†ï¼‰",
        "range_mask_notes": "make_range_mask(cells, start, end, color) è¿”å›åŠé€æ˜é®ç½© Rectangleï¼Œç›´æ¥ FadeIn è¦†ç›–åœ¨æ ¼å­ä¸Š"
      }
    },
    {
      "id": "result",
      "segment_no": 6,
      "type": "bisect_result",
      "duration_hint_s": "6~9",
      "narration": "FILL_IN_æè¿°æœ€ç»ˆç»“æœï¼šæ‰¾åˆ°/æœªæ‰¾åˆ°ã€‚",
      "narration_examples": {
        "found":     "æ‰¾åˆ°äº†ï¼ç›®æ ‡å€¼7å°±åœ¨ç´¢å¼•3çš„ä½ç½®ï¼Œè¿”å›3ã€‚",
        "not_found": "leftå·²ç»è¶…è¿‡rightï¼Œè¯´æ˜æ•°ç»„é‡Œæ²¡æœ‰ç›®æ ‡å€¼ï¼Œè¿”å›-1ã€‚"
      },
      "visual": {
        "found_path": {
          "elements": [
            "ç›®æ ‡æ ¼ï¼šcells[result_idx][0].animate.set_fill(C_NODE_RESULT)",
            "Indicate(ç›®æ ‡æ ¼, scale_factor=1.3)",
            "result_box('æ‰¾åˆ°äº†ï¼ç´¢å¼• = FILL_IN_idx')ï¼Œto_edge(DOWN)"
          ]
        },
        "not_found_path": {
          "elements": [
            "æ‰€æœ‰æ ¼å˜ç°ï¼šAnimationGroup([c[0].animate.set_fill('#374151') for c in cells])",
            "result_box('æœªæ‰¾åˆ°ï¼Œè¿”å› -1'ï¼Œfill=C_RANGE_R)"
          ]
        }
      }
    },
    {
      "id": "summary",
      "segment_no": 7,
      "type": "answer_reveal",
      "duration_hint_s": "10~14",
      "narration": "FILL_IN_æ€»ç»“ç­”æ¡ˆå’Œå…³é”®è§„åˆ™ã€‚ä¸è¶…è¿‡50å­—ã€‚",
      "narration_examples": {
        "found":     "äºŒåˆ†æŸ¥æ‰¾çš„ç­”æ¡ˆæ˜¯ç´¢å¼•3ã€‚è®°ä½å£è¯€ï¼šæ¯æ¬¡ç æ‰ä¸€åŠï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯O(log n)ã€‚8ä¸ªæ•°åªéœ€è¦æœ€å¤š3æ¬¡å°±èƒ½æ‰¾åˆ°ï¼",
        "not_found": "ç›®æ ‡å€¼ä¸åœ¨æ•°ç»„é‡Œï¼Œè¿”å›-1ã€‚äºŒåˆ†æŸ¥æ‰¾çš„æ ¸å¿ƒæ˜¯æœ‰åºæ•°ç»„ï¼Œæ¯æ¬¡æŠŠæœç´¢èŒƒå›´ç¼©å°ä¸€åŠã€‚"
      },
      "visual": {
        "layout": "æ¸…ç©ºå‰ä¸€æ®µï¼Œå±…ä¸­é“ºæ»¡",
        "elements": [
          {"role": "é—®é¢˜å›é¡¾", "text": "FILL_INï¼ˆå¦‚ï¼štarget=7 çš„ç´¢å¼• =ï¼‰", "style": "font_size=34, C_MUTED"},
          {"role": "å¤§å·ç­”æ¡ˆ", "text": "FILL_INï¼ˆå¦‚ï¼šç´¢å¼• 3 / æœªæ‰¾åˆ° -1ï¼‰", "style": "result_box, font_size=56"},
          {"role": "å…³é”®æç¤º", "text": "ğŸ’¡ æ¯æ¬¡ç¼©å°ä¸€åŠï¼Œæ—¶é—´å¤æ‚åº¦ O(log n)", "style": "insight_box"}
        ],
        "animation_sequence": [
          "FadeOut(self._result_grp)",
          "FadeIn(é—®é¢˜å›é¡¾)",
          "DrawBorderThenFill(ç­”æ¡ˆæ¡†) + FadeIn(ç­”æ¡ˆ)",
          "DrawBorderThenFill(æç¤ºæ¡†) + FadeIn(æç¤º)",
          "wait(çº¦8ç§’)"
        ]
      }
    }
  ]
}
